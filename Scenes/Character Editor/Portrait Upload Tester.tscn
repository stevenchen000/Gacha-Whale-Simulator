[gd_scene load_steps=10 format=3 uid="uid://cr2qhdqndnhyv"]

[ext_resource type="Script" path="res://Scripts/Character Creator/ImageSaver.cs" id="2_w71uh"]
[ext_resource type="Script" path="res://Scripts/Character Creator/ImageCropper.cs" id="3_iqtm1"]
[ext_resource type="Script" path="res://Scripts/Character Creator/Creation State/CharacterCreatorIdleState.cs" id="4_5hbb8"]
[ext_resource type="Script" path="res://Scripts/Character Creator/Creation State/CharacterCreatorCropState.cs" id="5_m48ev"]
[ext_resource type="Script" path="res://Scripts/Character Creator/Creation State/CharacterCreatorAdjustCropState.cs" id="6_fdw83"]
[ext_resource type="Texture2D" uid="uid://wdgy25x7fcji" path="res://Art Assets/Placeholder Characters/Waifus/Aranea.png" id="7_4li6e"]
[ext_resource type="PackedScene" uid="uid://dwembdyqg2pyg" path="res://Scenes/Character Editor/portrait_preview.tscn" id="8_vyd43"]

[sub_resource type="CanvasTexture" id="CanvasTexture_tcckp"]

[sub_resource type="CanvasTexture" id="CanvasTexture_5hfmi"]

[node name="PortraitUploadTester" type="Node2D"]

[node name="Image Importer" type="Node2D" parent="."]
position = Vector2(97, 118)

[node name="Image Saver" type="Node2D" parent="." node_paths=PackedStringArray("spriteToEdit", "secondSprite")]
script = ExtResource("2_w71uh")
spriteToEdit = NodePath("../Sprite To Edit")
secondSprite = NodePath("../Cropper/Crop Box/Second Sprite")

[node name="Image Cropper" type="Node2D" parent="." node_paths=PackedStringArray("spriteToEdit", "secondSprite", "cropBox", "cropCover", "cam")]
script = ExtResource("3_iqtm1")
spriteToEdit = NodePath("../Sprite To Edit")
secondSprite = NodePath("../Cropper/Crop Box/Second Sprite")
cropBox = NodePath("../Cropper/Crop Box")
cropCover = NodePath("../Cropper/Crop Cover")
cam = NodePath("../Camera2D")

[node name="States" type="Node2D" parent="Image Cropper"]

[node name="Idle State" type="Node2D" parent="Image Cropper/States" node_paths=PackedStringArray("spriteToEdit", "cropState")]
script = ExtResource("4_5hbb8")
spriteToEdit = NodePath("../../../Sprite To Edit")
cropState = NodePath("../Initial Crop State")
IsInitialState = true

[node name="Initial Crop State" type="Node2D" parent="Image Cropper/States" node_paths=PackedStringArray("spriteToEdit", "adjustState")]
script = ExtResource("5_m48ev")
spriteToEdit = NodePath("../../../Sprite To Edit")
adjustState = NodePath("../Adjust Crop State")

[node name="Adjust Crop State" type="Node2D" parent="Image Cropper/States" node_paths=PackedStringArray("spriteToEdit", "cropBox", "cam")]
script = ExtResource("6_fdw83")
spriteToEdit = NodePath("../../../Sprite To Edit")
cropBox = NodePath("../../../Cropper/Crop Box")
cam = NodePath("../../../Camera2D")

[node name="=====Background====" type="CanvasLayer" parent="."]

[node name="Background" type="TextureRect" parent="=====Background===="]
offset_right = 40.0
offset_bottom = 40.0

[node name="Sprite To Edit" type="Sprite2D" parent="."]

[node name="Cropper" type="Control" parent="."]
self_modulate = Color(0, 0, 0, 0.623529)
layout_mode = 3
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_right = 1e+07
offset_bottom = 1e+07
grow_horizontal = 2
grow_vertical = 2

[node name="Crop Cover" type="TextureRect" parent="Cropper"]
visible = false
self_modulate = Color(0, 0, 0, 0.623529)
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -5.05e+06
offset_top = -5.05e+06
offset_right = 4.95e+06
offset_bottom = 4.95e+06
grow_horizontal = 2
grow_vertical = 2
texture = SubResource("CanvasTexture_tcckp")

[node name="Crop Box" type="TextureRect" parent="Cropper"]
self_modulate = Color(1, 1, 1, 0.701961)
clip_children = 2
layout_mode = 0
offset_left = -15.0
offset_top = -19.0
offset_right = -14.0
offset_bottom = -18.0
texture = SubResource("CanvasTexture_5hfmi")

[node name="Second Sprite" type="Sprite2D" parent="Cropper/Crop Box"]
position = Vector2(165, 177)
texture = ExtResource("7_4li6e")

[node name="=========UI==========" type="CanvasLayer" parent="."]

[node name="VBoxContainer" type="VBoxContainer" parent="=========UI=========="]
offset_right = 40.0
offset_bottom = 40.0
theme_override_constants/separation = 20

[node name="Create Character Button" type="Button" parent="=========UI==========/VBoxContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 50
text = "Create 
Character
"

[node name="Create Character Button2" type="Button" parent="=========UI==========/VBoxContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 50
text = "Create 
Portrait
"

[node name="Import Image Button" type="Button" parent="=========UI==========/VBoxContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 50
text = "Import 
Image"

[node name="Crop Button" type="Button" parent="=========UI==========/VBoxContainer"]
visible = false
layout_mode = 2
theme_override_font_sizes/font_size = 50
text = "Crop"

[node name="Save Button" type="Button" parent="=========UI==========/VBoxContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 50
text = "Save Image"

[node name="Load Button" type="Button" parent="=========UI==========/VBoxContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 50
text = "Load Image"

[node name="Camera2D" type="Camera2D" parent="."]

[node name="====Preview=====" type="CanvasLayer" parent="."]

[node name="Preview Background" parent="====Preview=====" instance=ExtResource("8_vyd43")]

[connection signal="button_up" from="=========UI==========/VBoxContainer/Import Image Button" to="Image Importer" method="_import_image"]
[connection signal="button_up" from="=========UI==========/VBoxContainer/Save Button" to="Image Saver" method="SaveImage"]
[connection signal="button_up" from="=========UI==========/VBoxContainer/Load Button" to="Image Saver" method="LoadImage"]
